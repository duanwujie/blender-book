BUILD = build
BOOKNAME = my-book
TITLE = title.txt
METADATA = metadata.xml
#CHAPTERS = 0.md 1.md 2.md 3.md 4.md 5.md 6.md 8.md 7.md 9.md 10.md 11.md 12.md 13.md 14.md 15.md 16.md 17.md 18.md 19.md 20.md 21.md 22.md 23.md 24.md 25.md 26.md 27.md 28.md 29.md 30.md 31.md 32.md 33.md 34.md 35.md 36.md 37.md 38.md 39.md

CHAPTERS=Background.md \
Knowing_before_Making.md \
What_Blender_can_do.md \
Section_1A__3D_Consepts.md \
3D_Geometry.md \
Coordinate_Transformations.md \
Orthographic_Views.md \
Perspective_Views.md \
Coordinate_Spaces_in_Blender.md \
Section_1B__User_Interface.md \
Overview.md \
Keystroke_Button_and_Menu_Notation.md \
Non_standard_Input_Devices.md \
Operating_System_specific_Issues.md \
Blender_User_Interface.md \
Blender_Windowing_System.md \
User_Preferences_Windows.md \
Properties_Window.md \
3D_View_Windows.md \
Object_Mode.md \
Unit_2__Basic_Modeling_and_Shading.md \
You_first_mesh_models.md \
Mesh_and_Edit_Mode.md \
Normals_and_Shading.md \
More_Mesh_Editing_Techniques.md \
Quickie_Lighting.md \
Quickie_Model.md \
Quickie_Render.md \
Enter_the_World.md \
Understanding_the_Camera.md \
Improving_Your_House.md \
Section_2B__Smooth_Meshes.md \
Extruding_a_Simple_Person.md \
Smoothing_Your_Simple_Person.md \
Improving_Your_Simple_Person.md \
Spinning_a_Simple_Hat.md \
Putting_the_Hat_on_the_Person.md \
Section_2C__Materials_and_Textures.md \
Overview.md \
Quickie_Material.md \
Multiple_Materials_per_Object.md \
Metal_Versus_Plastic.md \
Texture_Settings.md \
Image_Textures.md \
Procedural_Textures.md \
Quickie_Texture.md \
Halo_Materials.md \
Beyond_Basics.md \
Blender_Memory_Management.md \
Using_Bones.md \
Mountains_out_of_Molehills.md \
Modeling_a_Volcano.md \
Penguins_from_Spheres.md \
Dicing_With_Depth.md \
Model_a_Goblet.md \
Model_a_Silver_Goblet.md \
Model_a_Silver_Goblet_Another_Way.md \
Spin_a_goblet.md \
Light_a_Silver_Goblet.md \
Simple_Vehicle.md \
Simple_Vehicle__Wheel_tutorial_1.md \
Simple_Vehicle__Wheel_tutorial_2.md \
Simple_Vehicle__Seat.md \
Simple_Vehicle__Rocket_Launcher.md \
Simple_Vehicle__Body.md \
Simple_Vehicle__Some_Assembly_Required.md \
Modeling_a_3D_Parachute_in_Blender.md \
Model_a_Low_Poly_Head.md \
Building_a_House.md \
Pipe_joints.md \
Lighting_Suzanne__Introductory_one_lamp_lighting.md \
Curve_and_Path_Modeling.md \
Overview.md \
Intro_to_Bezier_Curves.md \
Bevelling_a_Curve.md \
NURBS_Patches.md \
Deforming_Meshes_using_the_Curve_Modifier.md \
The_Empty_Object.md \
Using_Reference_Photos.md \
Background_Images.md \
Aligning_Vertices_with_a_Guide_Image.md \
Modeling_a_Wolf_from_Guide_Images.md \
Using_Bezier_Curve_to_Model_a_3D_logo_from_a_2D_logo.md \
Further_Materials_and_Textures.md \
Subsurface_Scattering.md \
Ray_Tracing.md \
Using_Textures.md \
Using_a_texture_to_make_a_material_partially_transparent.md \
Creating_Basic_Seawater.md \
Mountains_Out_Of_Molehills_2.md \
Basic_Carpet_Texture.md \
The_Rusty_Ball.md \
Creating_Pixar_looking_eyes.md \
Procedural_Eyeball.md \
Putting_It_All_Together__A_Dragon!.md \
Unit_3__Broadening_Horizons.md \
The_UV_Image_Editor.md \
UV_Maps___Pasting_photos_to_3D_surfaces.md \
UV_Map_Basics.md \
Realistic_Eyes_In_Blender.md \
Lighting.md \
Beginning_Lighting.md \
Understanding_Real_Lights.md \
Understanding_Blender_Lights.md \
Basic_Lighting_Rigs.md \
Faked_Global_Illumination_with_Blender_internal.md \
Practicing_Good_Parenting.md \
Basic_Animation.md \
Overview.md \
Introduction_to_Keyframing.md \
The_Ways_of_the_Animator.md \
Animation_Editors.md \
Introducing_the_Graph_Editor.md \
Animation_Rendering.md \
Lattice_Modifier.md \
Bouncing_Ball_with_Lattice.md \
Creating_Basic_Water_Animation.md \
Flying_Through_a_Canyon.md \
Using_the_Sequencer_to_Compile_Frames_into_an_Animation.md \
Further_Rendering_Options.md \
Particle_Systems.md \
Overview.md \
Fire.md \
Fur.md \
Fireworks.md \
Particles_forming_Shapes.md \
Billboard_Animation.md \
Soft_Bodies.md \
Soft_Body_Animation.md \
Simple_Cloth_Animation.md \
Soft_Body_with_Wind.md \
Blender_Game_Engine.md \
Blender_Game_Engine_Basics__Rolling_Ball.md \
Platformer__Controls_and_Movement.md \
Maze__Force_and_Multiple_Levels.md \
Platformer__Improving_the_Physics.md \
How_to_Make_an_Executable.md \
Build_a_Skybox.md \
Basic_Mouse_Pointer.md \
Text_in_BGE.md \
Platformer__Creating_the_Engine_with_Python.md \
Unit_4__Taking_Off_with_Advanced_Tutorials.md \
Python_Scripting.md \
Introduction.md \
Anatomy_Of_An_Addon.md \
A_User_Interface_For_Your_Addon.md \
Adding_A_Custom_Property.md \
A_Separately_Installable_Addon.md \
Object_Action_Settings.md \
Advanced_Modeling.md \
Overview.md \
High_Dynamic_Range_imaging.md \
Creating_a_Light_Probe.md \
Landscape_Modeling_with_Heightmaps.md \
How_to_Do_Procedural_Landscape_Modeling.md \
Landscape_Modeling_I__Basic_Terrain.md \
Landscape_Modeling_II__Texture_Stenciling.md \
Landscape_Modeling_III__Exporting_as_a_Heightmap.md \
Advanced_Materials_and_Textures.md \
Bump_Mapping.md \
Normal_Mapping.md \
Texture_Normals.md \
Color_Map_Normals.md \
Nodes.md \
Introduction.md \
Texture_Nodes.md \
Material_Nodes.md \
Compositing.md \
Further_Compositing__A_Portal_Effect.md \
Advanced_Rendering.md \
Introduction_to_Cycles.md \
A_Glass_Material_in_Cycles.md \
Dealing_with_Fireflies_in_Cycles.md \
Fireflies_in_Cycles_Continued.md \
Procedural_Eyeball_in_Cycles.md \
Introduction_to_Freestyle.md \
Advanced_Animation.md \
Overview.md \
Introduction.md \
Guided_Tour_.md \
Armature_Object.md \
Armature_Object_in_Object_Mode.md \
Armature_Object_in_Edit_Mode.md \
Armature_Object_in_Pose_mode.md \
Mesh_Object.md \
Connection_between_Armature_and_Mesh.md \
Envelope.md \
Vertex_Groups___Weight_Paint.md \
Shape_Keys.md \
Lip_Sync_with_Shape_Keys.md \
Constraints.md \
Copy_Location.md \
Copy_Rotation.md \
Track_To.md \
Floor.md \
Locked_Track.md \
Follow_Path.md \
Stretch_To.md \
IK_Solver.md \
Timeline_Window.md \
Graph_Editor.md \
Dope_Sheet.md \
NLA_Editor.md \
Introduction_To_NLA_Editor.md \
Working_Example__Bob.md \
Building_the_Rig.md \
Deform_the_Mesh.md \
Create_a_Walk_Cycle.md \
Working_example__Piston_Rod_and_Crank.md \
Working_example__Cutting_Through_Steel.md \
Advanced_Game_Engine.md \
Overview.md \
Advanced_Game_Engine_Techniques.md \
Creating_Pop_Up_Menus.md \
Creating_Dropping_Menus.md \
Creating_Object_Outlines.md \
Advanced_Game_Engine_Techniques.md \
Hacking_Blender.md \
Introduction_to_Game_Engine_Source.md \
Appendices.md \
Glossary.md \
Frequently_Asked_Questions.md \
Tutorial_Links_List.md \
Hotkeys.md \
Output_Formats.md \
Image_Portfolio.md \
Blender_Glossary.md \
Materials_Directory__Every_Material_Known_To_Man.md \
Sources_of_free_3D_models.md \
Sources_of_free_3D_models_for_additional_study.md \
All_Blueprints_Links.md \
Materials_Textures_Photos.md \
Sources_of_free_materials_textures_and_photos.md \
Asking_for_Help.md \
Modeling_Realistically.md \
Modeling_tips.md \
Cheat_the_3D.md \
Performance_vs._Quality.md \
Modeling_a_Gingerbread_Man.md \
Modeling_a_simple_space_ship.md \
Create_an_animated_GIF_wallpaper.md \
Part_1___Preparing_the_Scene.md \
Creating_Weapons_based_on_2D_Images.md \
Modeling_with_Meta_Balls.md \
Match_Moving.md \
Match_Moving_Motion_Tracking_with_Icarus_and_Blender.md \
Create_a_Clayman.md \
Organic_Modeling.md \
Understanding_the_Fluid_Simulator.md \
Creating_a_jewel_in_Blender.md \
Modeling_a_picture.md \
Modeling_with_the_Spin_Tool.md \
Spin_Tool_Introduction.md \
Illustrative_Example__Model_a_Wine_Glass.md \
Creating_Ogg_Theora_movies_using_Blender.md \
Creating_animated_GIFs_using_Blender_and_Gimp.md \
3D_Tiling_Backgrounds_For_The_Web.md \
Cool_Things_That_Arent_That_Obvious_in_Blender.md \
Troubleshooting.md \
Creating_Blender_Libraries.md \
Add_some_depth_with_stereo.md \
Ways_to_create_a_fluffy_effect.md \
Human_Body.md \
Rendering_Information.md \
Using_Blender_Libraries.md \
Beginning_Modeling_Final_Project.md \
Using_Inkscape_to_make_advanced_Bezier_curves.md \
Light_Mapping.md \
Platonic_Solids.md \
Polygonal_Modeling.md \
Box_Modeling.md \
Illustrative_example__Model_a_Chair.md \
Model_a_Chair_Preparations.md \
Model_a_Chair_The_Seat.md \
Model_a_Chair_The_Feet.md \
Illustrative_Example__Modeling_a_Simple_Human_Character.md \
Modeling_a_Human_Character___Preparations.md \
Modeling_a_Human_Character___Modeling.md \
Polygon_by_Polygon_modeling.md \
Animation_Notes_and_FAQ.md \
Customization.md \
Mist___Make_Objects_Opaque.md
	
#glossary.md 
			

TOC = --toc --toc-depth=4
COVER_IMAGE = images/cover.jpg
LATEX_CLASS = book
#MAINFONT = "AR PL UMing CN"
#MAINFONT = "宋体"
MAINFONT = "SimSun"

REFLIST=reference.md

all: book

book: epub html pdf

clean:
	rm -r $(BUILD)

epub: $(BUILD)/epub/$(BOOKNAME).epub

html: $(BUILD)/html/$(BOOKNAME).html

pdf: $(BUILD)/pdf/$(BOOKNAME).pdf

$(BUILD)/epub/$(BOOKNAME).epub: $(TITLE) $(CHAPTERS) $(REFLIST)
	mkdir -p $(BUILD)/epub
	#pandoc $(TOC) -S --epub-metadata=$(METADATA) --epub-cover-image=$(COVER_IMAGE) -o $@ $^

$(BUILD)/html/$(BOOKNAME).html: $(CHAPTERS)
	mkdir -p $(BUILD)/html
	pandoc $(TOC) --standalone --to=html5 -o $@ $^

$(BUILD)/pdf/$(BOOKNAME).pdf: $(TITLE) $(CHAPTERS) $(REFLIST)
	mkdir -p $(BUILD)/pdf
	#pandoc $(TOC) --latex-engine=xelatex --template eisvogel.tex -o $@ $^
	#pandoc -N -s --toc --smart --latex-engine=xelatex -V CJKmainfont=$(MAINFONT) -V mainfont=$(MAINFONT) -V geometry:margin=1in -o $@ $^
	pandoc  --toc --smart --template=pm-template --latex-engine=xelatex -V mainfont=$(MAINFONT) -V documentclass=$(LATEX_CLASS) -o $@ $^

.PHONY: all book clean epub html pdf




