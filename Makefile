BUILD = build
BOOKNAME = my-book
TITLE = title.txt
METADATA = metadata.xml
#CHAPTERS = 0.md 1.md 2.md 3.md 4.md 5.md 6.md 8.md 7.md 9.md 10.md 11.md 12.md 13.md 14.md 15.md 16.md 17.md 18.md 19.md 20.md 21.md 22.md 23.md 24.md 25.md 26.md 27.md 28.md 29.md 30.md 31.md 32.md 33.md 34.md 35.md 36.md 37.md 38.md 39.md

CHAPTERS=src/Background.md \
src/Knowing_before_Making.md \
src/What_Blender_can_do.md \
src/Section_1A__3D_Consepts.md \
src/3D_Geometry.md \
src/Coordinate_Transformations.md \
src/Orthographic_Views.md \
src/Perspective_Views.md \
src/Coordinate_Spaces_in_Blender.md \
src/Section_1B__User_Interface.md \
src/Overview.md \
src/Keystroke_Button_and_Menu_Notation.md \
src/Non_standard_Input_Devices.md \
src/Operating_System_specific_Issues.md \
src/Blender_User_Interface.md \
src/Blender_Windowing_System.md \
src/User_Preferences_Windows.md \
src/Properties_Window.md \
src/3D_View_Windows.md \
src/Object_Mode.md \
src/Unit_2__Basic_Modeling_and_Shading.md \
src/You_first_mesh_models.md \
src/Mesh_and_Edit_Mode.md \
src/Normals_and_Shading.md \
src/More_Mesh_Editing_Techniques.md \
src/Quickie_Lighting.md \
src/Quickie_Model.md \
src/Quickie_Render.md \
src/Enter_the_World.md \
src/Understanding_the_Camera.md \
src/Improving_Your_House.md \
src/Section_2B__Smooth_Meshes.md \
src/Extruding_a_Simple_Person.md \
src/Smoothing_Your_Simple_Person.md \
src/Improving_Your_Simple_Person.md \
src/Spinning_a_Simple_Hat.md \
src/Putting_the_Hat_on_the_Person.md \
src/Section_2C__Materials_and_Textures.md \
src/Overview.md \
src/Quickie_Material.md \
src/Multiple_Materials_per_Object.md \
src/Metal_Versus_Plastic.md \
src/Texture_Settings.md \
src/Image_Textures.md \
src/Procedural_Textures.md \
src/Quickie_Texture.md \
src/Halo_Materials.md \
src/Beyond_Basics.md \
src/Blender_Memory_Management.md \
src/Using_Bones.md \
src/Mountains_out_of_Molehills.md \
src/Modeling_a_Volcano.md \
src/Penguins_from_Spheres.md \
src/Dicing_With_Depth.md \
src/Model_a_Goblet.md \
src/Model_a_Silver_Goblet.md \
src/Model_a_Silver_Goblet_Another_Way.md \
src/Spin_a_goblet.md \
src/Light_a_Silver_Goblet.md \
src/Simple_Vehicle.md \
src/Simple_Vehicle__Wheel_tutorial_1.md \
src/Simple_Vehicle__Wheel_tutorial_2.md \
src/Simple_Vehicle__Seat.md \
src/Simple_Vehicle__Rocket_Launcher.md \
src/Simple_Vehicle__Body.md \
src/Simple_Vehicle__Some_Assembly_Required.md \
src/Modeling_a_3D_Parachute_in_Blender.md \
src/Model_a_Low_Poly_Head.md \
src/Building_a_House.md \
src/Pipe_joints.md \
src/Lighting_Suzanne__Introductory_one_lamp_lighting.md \
src/Curve_and_Path_Modeling.md \
src/Overview.md \
src/Intro_to_Bezier_Curves.md \
src/Bevelling_a_Curve.md \
src/NURBS_Patches.md \
src/Deforming_Meshes_using_the_Curve_Modifier.md \
src/The_Empty_Object.md \
src/Using_Reference_Photos.md \
src/Background_Images.md \
src/Aligning_Vertices_with_a_Guide_Image.md \
src/Modeling_a_Wolf_from_Guide_Images.md \
src/Using_Bezier_Curve_to_Model_a_3D_logo_from_a_2D_logo.md \
src/Further_Materials_and_Textures.md \
src/Subsurface_Scattering.md \
src/Ray_Tracing.md \
src/Using_Textures.md \
src/Using_a_texture_to_make_a_material_partially_transparent.md \
src/Creating_Basic_Seawater.md \
src/Mountains_Out_Of_Molehills_2.md \
src/Basic_Carpet_Texture.md \
src/The_Rusty_Ball.md \
src/Creating_Pixar_looking_eyes.md \
src/Procedural_Eyeball.md \
src/Putting_It_All_Together__A_Dragon!.md \
src/Unit_3__Broadening_Horizons.md \
src/The_UV_Image_Editor.md \
src/UV_Maps___Pasting_photos_to_3D_surfaces.md \
src/UV_Map_Basics.md \
src/Realistic_Eyes_In_Blender.md \
src/Lighting.md \
src/Beginning_Lighting.md \
src/Understanding_Real_Lights.md \
src/Understanding_Blender_Lights.md \
src/Basic_Lighting_Rigs.md \
src/Faked_Global_Illumination_with_Blender_internal.md \
src/Practicing_Good_Parenting.md \
src/Basic_Animation.md \
src/Overview.md \
src/Introduction_to_Keyframing.md \
src/The_Ways_of_the_Animator.md \
src/Animation_Editors.md \
src/Introducing_the_Graph_Editor.md \
src/Animation_Rendering.md \
src/Lattice_Modifier.md \
src/Bouncing_Ball_with_Lattice.md \
src/Creating_Basic_Water_Animation.md \
src/Flying_Through_a_Canyon.md \
src/Using_the_Sequencer_to_Compile_Frames_into_an_Animation.md \
src/Further_Rendering_Options.md \
src/Particle_Systems.md \
src/Overview.md \
src/Fire.md \
src/Fur.md \
src/Fireworks.md \
src/Particles_forming_Shapes.md \
src/Billboard_Animation.md \
src/Soft_Bodies.md \
src/Soft_Body_Animation.md \
src/Simple_Cloth_Animation.md \
src/Soft_Body_with_Wind.md \
src/Blender_Game_Engine.md \
src/Blender_Game_Engine_Basics__Rolling_Ball.md \
src/Platformer__Controls_and_Movement.md \
src/Maze__Force_and_Multiple_Levels.md \
src/Platformer__Improving_the_Physics.md \
src/How_to_Make_an_Executable.md \
src/Build_a_Skybox.md \
src/Basic_Mouse_Pointer.md \
src/Text_in_BGE.md \
src/Platformer__Creating_the_Engine_with_Python.md \
src/Unit_4__Taking_Off_with_Advanced_Tutorials.md \
src/Python_Scripting.md \
src/Introduction.md \
src/Anatomy_Of_An_Addon.md \
src/A_User_Interface_For_Your_Addon.md \
src/Adding_A_Custom_Property.md \
src/A_Separately_Installable_Addon.md \
src/Object_Action_Settings.md \
src/Advanced_Modeling.md \
src/Overview.md \
src/High_Dynamic_Range_imaging.md \
src/Creating_a_Light_Probe.md \
src/Landscape_Modeling_with_Heightmaps.md \
src/How_to_Do_Procedural_Landscape_Modeling.md \
src/Landscape_Modeling_I__Basic_Terrain.md \
src/Landscape_Modeling_II__Texture_Stenciling.md \
src/Landscape_Modeling_III__Exporting_as_a_Heightmap.md \
src/Advanced_Materials_and_Textures.md \
src/Bump_Mapping.md \
src/Normal_Mapping.md \
src/Texture_Normals.md \
src/Color_Map_Normals.md \
src/Nodes.md \
src/Introduction.md \
src/Texture_Nodes.md \
src/Material_Nodes.md \
src/Compositing.md \
src/Further_Compositing__A_Portal_Effect.md \
src/Advanced_Rendering.md \
src/Introduction_to_Cycles.md \
src/A_Glass_Material_in_Cycles.md \
src/Dealing_with_Fireflies_in_Cycles.md \
src/Fireflies_in_Cycles_Continued.md \
src/Procedural_Eyeball_in_Cycles.md \
src/Introduction_to_Freestyle.md \
src/Advanced_Animation.md \
src/Overview.md \
src/Introduction.md \
src/Guided_Tour_.md \
src/Armature_Object.md \
src/Armature_Object_in_Object_Mode.md \
src/Armature_Object_in_Edit_Mode.md \
src/Armature_Object_in_Pose_mode.md \
src/Mesh_Object.md \
src/Connection_between_Armature_and_Mesh.md \
src/Envelope.md \
src/Vertex_Groups___Weight_Paint.md \
src/Shape_Keys.md \
src/Lip_Sync_with_Shape_Keys.md \
src/Constraints.md \
src/Copy_Location.md \
src/Copy_Rotation.md \
src/Track_To.md \
src/Floor.md \
src/Locked_Track.md \
src/Follow_Path.md \
src/Stretch_To.md \
src/IK_Solver.md \
src/Timeline_Window.md \
src/Graph_Editor.md \
src/Dope_Sheet.md \
src/NLA_Editor.md \
src/Introduction_To_NLA_Editor.md \
src/Working_Example__Bob.md \
src/Building_the_Rig.md \
src/Deform_the_Mesh.md \
src/Create_a_Walk_Cycle.md \
src/Working_example__Piston_Rod_and_Crank.md \
src/Working_example__Cutting_Through_Steel.md \
src/Advanced_Game_Engine.md \
src/Overview.md \
src/Advanced_Game_Engine_Techniques.md \
src/Creating_Pop_Up_Menus.md \
src/Creating_Dropping_Menus.md \
src/Creating_Object_Outlines.md \
src/Advanced_Game_Engine_Techniques.md \
src/Hacking_Blender.md \
src/Introduction_to_Game_Engine_Source.md \
src/Appendices.md \
src/Glossary.md \
src/Frequently_Asked_Questions.md \
src/Tutorial_Links_List.md \
src/Hotkeys.md \
src/Output_Formats.md \
src/Image_Portfolio.md \
src/Blender_Glossary.md \
src/Materials_Directory__Every_Material_Known_To_Man.md \
src/Sources_of_free_3D_models.md \
src/Sources_of_free_3D_models_for_additional_study.md \
src/All_Blueprints_Links.md \
src/Materials_Textures_Photos.md \
src/Sources_of_free_materials_textures_and_photos.md \
src/Asking_for_Help.md \
src/Modeling_Realistically.md \
src/Modeling_tips.md \
src/Cheat_the_3D.md \
src/Performance_vs._Quality.md \
src/Modeling_a_Gingerbread_Man.md \
src/Modeling_a_simple_space_ship.md \
src/Create_an_animated_GIF_wallpaper.md \
src/Part_1___Preparing_the_Scene.md \
src/Creating_Weapons_based_on_2D_Images.md \
src/Modeling_with_Meta_Balls.md \
src/Match_Moving.md \
src/Match_Moving_Motion_Tracking_with_Icarus_and_Blender.md \
src/Create_a_Clayman.md \
src/Organic_Modeling.md \
src/Understanding_the_Fluid_Simulator.md \
src/Creating_a_jewel_in_Blender.md \
src/Modeling_a_picture.md \
src/Modeling_with_the_Spin_Tool.md \
src/Spin_Tool_Introduction.md \
src/Illustrative_Example__Model_a_Wine_Glass.md \
src/Creating_Ogg_Theora_movies_using_Blender.md \
src/Creating_animated_GIFs_using_Blender_and_Gimp.md \
src/3D_Tiling_Backgrounds_For_The_Web.md \
src/Cool_Things_That_Arent_That_Obvious_in_Blender.md \
src/Troubleshooting.md \
src/Creating_Blender_Libraries.md \
src/Add_some_depth_with_stereo.md \
src/Ways_to_create_a_fluffy_effect.md \
src/Human_Body.md \
src/Rendering_Information.md \
src/Using_Blender_Libraries.md \
src/Beginning_Modeling_Final_Project.md \
src/Using_Inkscape_to_make_advanced_Bezier_curves.md \
src/Light_Mapping.md \
src/Platonic_Solids.md \
src/Polygonal_Modeling.md \
src/Box_Modeling.md \
src/Illustrative_example__Model_a_Chair.md \
src/Model_a_Chair_Preparations.md \
src/Model_a_Chair_The_Seat.md \
src/Model_a_Chair_The_Feet.md \
src/Illustrative_Example__Modeling_a_Simple_Human_Character.md \
src/Modeling_a_Human_Character___Preparations.md \
src/Modeling_a_Human_Character___Modeling.md \
src/Polygon_by_Polygon_modeling.md \
src/Animation_Notes_and_FAQ.md \
src/Customization.md \
src/Mist___Make_Objects_Opaque.md
	
#glossary.md 
			

TOC = --toc --toc-depth=4
COVER_IMAGE = images/cover.jpg
LATEX_CLASS = book
#MAINFONT = "AR PL UMing CN"
#MAINFONT = "宋体"
MAINFONT = "SimSun"

REFLIST=reference.md

all: book

book: epub html pdf

clean:
	rm -r $(BUILD)

epub: $(BUILD)/epub/$(BOOKNAME).epub

html: $(BUILD)/html/$(BOOKNAME).html

pdf: $(BUILD)/pdf/$(BOOKNAME).pdf

$(BUILD)/epub/$(BOOKNAME).epub: $(TITLE) $(CHAPTERS) $(REFLIST)
	mkdir -p $(BUILD)/epub
	#pandoc $(TOC) -S --epub-metadata=$(METADATA) --epub-cover-image=$(COVER_IMAGE) -o $@ $^

$(BUILD)/html/$(BOOKNAME).html: $(CHAPTERS)
	mkdir -p $(BUILD)/html
	pandoc $(TOC) --standalone --to=html5 -o $@ $^

$(BUILD)/pdf/$(BOOKNAME).pdf: $(TITLE) $(CHAPTERS) $(REFLIST)
	mkdir -p $(BUILD)/pdf
	#pandoc $(TOC) --latex-engine=xelatex --template eisvogel.tex -o $@ $^
	#pandoc -N -s --toc --smart --latex-engine=xelatex -V CJKmainfont=$(MAINFONT) -V mainfont=$(MAINFONT) -V geometry:margin=1in -o $@ $^
	pandoc  --toc --smart --template=pm-template --latex-engine=xelatex -V mainfont=$(MAINFONT) -V documentclass=$(LATEX_CLASS) -o $@ $^

.PHONY: all book clean epub html pdf




